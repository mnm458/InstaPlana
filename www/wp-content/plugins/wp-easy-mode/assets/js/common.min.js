window.WPEM=window.WPEM||{},jQuery(document).ready(function(a){function b(b){wpem_vars.woocommerce.selected_payments;a(".wpem-woocommerce-payment-methods").show(),a("input.wpem_store_payment_methods").closest("label").show();for(var c=0;c<b.length;c++)b[c]='[value="'+b[c]+'"]';a("input.wpem_store_payment_methods").not(b.join(", ")).prop("checked",!1).closest("label").hide()}var c=(new Date).getTime()/1e3;window.WPEM.Form={beforeSubmit:function(b){var d=(new Date).getTime()/1e3;a("#wpem_step_took").val(parseFloat(d-c).toFixed(3)),b.find("input, select").blur(),b.find('input[type="submit"]').prop("disabled",!0).addClass("disabled"),this.displaySpinner();var e=a(".wpem-steps-list-item a");e.css("cursor","default"),e.on("click",function(a){a.preventDefault()})},displaySpinner:function(){a("#wpbody-content").block({css:{position:"fixed",width:"100%"},message:wpem_vars.i18n.loading_message,overlayCSS:{backgroundColor:"#fff",opacity:"0.9"}})}},a(".wpem-screen form").on("click","#wpem_no_thanks",function(b){b.preventDefault(),window.confirm(wpem_vars.i18n.exit_confirm)&&(window.WPEM.Form.displaySpinner(),a("#wpem_continue").val("no"),a(".wpem-screen form").submit())});var d=!1;a(".wpem-screen").on("submit","form",function(b){if(d)return!0;var c=a(this);return!!c[0].checkValidity()&&(b.preventDefault(),window.WPEM.Form.beforeSubmit(c),d=!0,-1===navigator.userAgent.indexOf("Safari")?(c.submit(),!1):void setTimeout(function(){c.submit()},250))}),a('input[name="wpem_site_type"]').on("click",function(){var b=a('input[name="wpem_woocommerce[calc_shipping]"], input[name="wpem_woocommerce[calc_taxes]"], *[name^="wpem_woocommerce[payment_methods]"], input[name="wpem_woocommerce[tax_type]"]');if("store"!==a(this).val())return a(".wpem-ecommerce-option-group").find('input[type="checkbox"], input[type="radio"], select').not(b).removeAttr("required"),void a(".wpem-ecommerce-option-group").slideUp();a(".wpem-ecommerce-option-group").find('input[type="checkbox"], input[type="radio"], select').not(b).attr("required","required"),a(".wpem-ecommerce-option-group").slideDown()}),a('input[name="wpem_woocommerce[calc_taxes]"]').on("change",function(){if(a(this).is(":checked"))return void a(".wpem-woocommerce-tax-type").slideDown();a(".wpem-woocommerce-tax-type").slideUp()}),a('input[name="wpem_woocommerce[calc_shipping]"]').on("change",function(){a(".wpem-woocommerce-weight-unit, .wpem-woocommerce-dimension-unit").slideToggle()}),a('select[name="wpem_woocommerce[store_location]"]').on("change",function(c){a.post(wpem_vars.ajax_url,{action:"tax_table_update",location_nonce:wpem_vars.ajax_nonce,location:a(c.currentTarget).val()},function(b){if(b.success)return a.isEmptyObject(b.data.tax_table)?void a(".wpem-woocommerce-tax-details").html(""):void a(".wpem-woocommerce-tax-details").replaceWith(b.data.tax_table)}),a.post(wpem_vars.ajax_url,{action:"update_payment_methods",location_nonce:wpem_vars.ajax_nonce,location:a(c.currentTarget).val()},function(c){if(c.success){var d=c.data.payment_methods;if(!d.length)return a(".wpem-woocommerce-payment-methods").hide(),void a("input.wpem_store_payment_methods").prop("checked",!1);if(b(d),a(".wpem-woocommerce-payment-methods .description").text(c.data.payment_description),a.isEmptyObject(c.data.tax_table))return void a(".wpem-woocommerce-tax-details").html("");a(".wpem-woocommerce-tax-details").html(c.data.tax_table)}})}),a('input[name="wpem_contact_info[enabled]"]').on("change",function(){a(".wpem-step-field").not(a(this).closest(".wpem-step-field")).not(a(".wpem-contact-info-enabled-notice").closest(".wpem-step-field")).slideToggle()})});